<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title></title>
  <style>
  @font-face {
  font-family: octicons-link;
  src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==) format('woff');
}

.markdown-body .octicon {
  display: inline-block;
  fill: currentColor;
  vertical-align: text-bottom;
}

.markdown-body .anchor {
  float: left;
  line-height: 1;
  margin-left: -20px;
  padding-right: 4px;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  color: #1b1f23;
  vertical-align: middle;
  visibility: hidden;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  visibility: visible;
}

.markdown-body {
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #24292e;
  line-height: 1.5;
  font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;
  font-size: 16px;
  line-height: 1.5;
  word-wrap: break-word;
}

.markdown-body .pl-c {
  color: #6a737d;
}

.markdown-body .pl-c1,
.markdown-body .pl-s .pl-v {
  color: #005cc5;
}

.markdown-body .pl-e,
.markdown-body .pl-en {
  color: #6f42c1;
}

.markdown-body .pl-s .pl-s1,
.markdown-body .pl-smi {
  color: #24292e;
}

.markdown-body .pl-ent {
  color: #22863a;
}

.markdown-body .pl-k {
  color: #d73a49;
}

.markdown-body .pl-pds,
.markdown-body .pl-s,
.markdown-body .pl-s .pl-pse .pl-s1,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sra,
.markdown-body .pl-sr .pl-sre {
  color: #032f62;
}

.markdown-body .pl-smw,
.markdown-body .pl-v {
  color: #e36209;
}

.markdown-body .pl-bu {
  color: #b31d28;
}

.markdown-body .pl-ii {
  background-color: #b31d28;
  color: #fafbfc;
}

.markdown-body .pl-c2 {
  background-color: #d73a49;
  color: #fafbfc;
}

.markdown-body .pl-c2:before {
  content: "^M";
}

.markdown-body .pl-sr .pl-cce {
  color: #22863a;
  font-weight: 700;
}

.markdown-body .pl-ml {
  color: #735c0f;
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
  color: #005cc5;
  font-weight: 700;
}

.markdown-body .pl-mi {
  color: #24292e;
  font-style: italic;
}

.markdown-body .pl-mb {
  color: #24292e;
  font-weight: 700;
}

.markdown-body .pl-md {
  background-color: #ffeef0;
  color: #b31d28;
}

.markdown-body .pl-mi1 {
  background-color: #f0fff4;
  color: #22863a;
}

.markdown-body .pl-mc {
  background-color: #ffebda;
  color: #e36209;
}

.markdown-body .pl-mi2 {
  background-color: #005cc5;
  color: #f6f8fa;
}

.markdown-body .pl-mdr {
  color: #6f42c1;
  font-weight: 700;
}

.markdown-body .pl-ba {
  color: #586069;
}

.markdown-body .pl-sg {
  color: #959da5;
}

.markdown-body .pl-corl {
  color: #032f62;
  text-decoration: underline;
}

.markdown-body details {
  display: block;
}

.markdown-body summary {
  display: list-item;
}

.markdown-body a {
  background-color: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline-width: 0;
}

.markdown-body strong {
  font-weight: inherit;
  font-weight: bolder;
}

.markdown-body h1 {
  font-size: 2em;
  margin: .67em 0;
}

.markdown-body img {
  border-style: none;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre {
  font-family: monospace,monospace;
  font-size: 1em;
}

.markdown-body hr {
  box-sizing: content-box;
  height: 0;
  overflow: visible;
}

.markdown-body input {
  font: inherit;
  margin: 0;
}

.markdown-body input {
  overflow: visible;
}

.markdown-body [type=checkbox] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body * {
  box-sizing: border-box;
}

.markdown-body input {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

.markdown-body a {
  color: #0366d6;
  text-decoration: none;
}

.markdown-body a:hover {
  text-decoration: underline;
}

.markdown-body strong {
  font-weight: 600;
}

.markdown-body hr {
  background: transparent;
  border: 0;
  border-bottom: 1px solid #dfe2e5;
  height: 0;
  margin: 15px 0;
  overflow: hidden;
}

.markdown-body hr:before {
  content: "";
  display: table;
}

.markdown-body hr:after {
  clear: both;
  content: "";
  display: table;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body details summary {
  cursor: pointer;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body h1 {
  font-size: 32px;
}

.markdown-body h1,
.markdown-body h2 {
  font-weight: 600;
}

.markdown-body h2 {
  font-size: 24px;
}

.markdown-body h3 {
  font-size: 20px;
}

.markdown-body h3,
.markdown-body h4 {
  font-weight: 600;
}

.markdown-body h4 {
  font-size: 16px;
}

.markdown-body h5 {
  font-size: 14px;
}

.markdown-body h5,
.markdown-body h6 {
  font-weight: 600;
}

.markdown-body h6 {
  font-size: 12px;
}

.markdown-body p {
  margin-bottom: 10px;
  margin-top: 0;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ol,
.markdown-body ul {
  margin-bottom: 0;
  margin-top: 0;
  padding-left: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ol ol ol,
.markdown-body ol ul ol,
.markdown-body ul ol ol,
.markdown-body ul ul ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre {
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body input::-webkit-inner-spin-button,
.markdown-body input::-webkit-outer-spin-button {
  -webkit-appearance: none;
  appearance: none;
  margin: 0;
}

.markdown-body .border {
  border: 1px solid #e1e4e8!important;
}

.markdown-body .border-0 {
  border: 0!important;
}

.markdown-body .border-bottom {
  border-bottom: 1px solid #e1e4e8!important;
}

.markdown-body .rounded-1 {
  border-radius: 3px!important;
}

.markdown-body .bg-white {
  background-color: #fff!important;
}

.markdown-body .bg-gray-light {
  background-color: #fafbfc!important;
}

.markdown-body .text-gray-light {
  color: #6a737d!important;
}

.markdown-body .mb-0 {
  margin-bottom: 0!important;
}

.markdown-body .my-2 {
  margin-bottom: 8px!important;
  margin-top: 8px!important;
}

.markdown-body .pl-0 {
  padding-left: 0!important;
}

.markdown-body .py-0 {
  padding-bottom: 0!important;
  padding-top: 0!important;
}

.markdown-body .pl-1 {
  padding-left: 4px!important;
}

.markdown-body .pl-2 {
  padding-left: 8px!important;
}

.markdown-body .py-2 {
  padding-bottom: 8px!important;
  padding-top: 8px!important;
}

.markdown-body .pl-3,
.markdown-body .px-3 {
  padding-left: 16px!important;
}

.markdown-body .px-3 {
  padding-right: 16px!important;
}

.markdown-body .pl-4 {
  padding-left: 24px!important;
}

.markdown-body .pl-5 {
  padding-left: 32px!important;
}

.markdown-body .pl-6 {
  padding-left: 40px!important;
}

.markdown-body .f6 {
  font-size: 12px!important;
}

.markdown-body .lh-condensed {
  line-height: 1.25!important;
}

.markdown-body .text-bold {
  font-weight: 600!important;
}

.markdown-body:before {
  content: "";
  display: table;
}

.markdown-body:after {
  clear: both;
  content: "";
  display: table;
}

.markdown-body>:first-child {
  margin-top: 0!important;
}

.markdown-body>:last-child {
  margin-bottom: 0!important;
}

.markdown-body a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.markdown-body blockquote,
.markdown-body dl,
.markdown-body ol,
.markdown-body p,
.markdown-body pre,
.markdown-body table,
.markdown-body ul {
  margin-bottom: 16px;
  margin-top: 0;
}

.markdown-body hr {
  background-color: #e1e4e8;
  border: 0;
  height: .25em;
  margin: 24px 0;
  padding: 0;
}

.markdown-body blockquote {
  border-left: .25em solid #dfe2e5;
  color: #6a737d;
  padding: 0 1em;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #fafbfc;
  border: 1px solid #c6cbd1;
  border-bottom-color: #959da5;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #959da5;
  color: #444d56;
  display: inline-block;
  font-size: 11px;
  line-height: 10px;
  padding: 3px 5px;
  vertical-align: middle;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  font-weight: 600;
  line-height: 1.25;
  margin-bottom: 16px;
  margin-top: 24px;
}

.markdown-body h1 {
  font-size: 2em;
}

.markdown-body h1,
.markdown-body h2 {
  border-bottom: 1px solid #eaecef;
  padding-bottom: .3em;
}

.markdown-body h2 {
  font-size: 1.5em;
}

.markdown-body h3 {
  font-size: 1.25em;
}

.markdown-body h4 {
  font-size: 1em;
}

.markdown-body h5 {
  font-size: .875em;
}

.markdown-body h6 {
  color: #6a737d;
  font-size: .85em;
}

.markdown-body ol,
.markdown-body ul {
  padding-left: 2em;
}

.markdown-body ol ol,
.markdown-body ol ul,
.markdown-body ul ol,
.markdown-body ul ul {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body li {
  word-wrap: break-all;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body li+li {
  margin-top: .25em;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  font-size: 1em;
  font-style: italic;
  font-weight: 600;
  margin-top: 16px;
  padding: 0;
}

.markdown-body dl dd {
  margin-bottom: 16px;
  padding: 0 16px;
}

.markdown-body table {
  display: block;
  overflow: auto;
  width: 100%;
}

.markdown-body table th {
  font-weight: 600;
}

.markdown-body table td,
.markdown-body table th {
  border: 1px solid #dfe2e5;
  padding: 6px 13px;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #c6cbd1;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f6f8fa;
}

.markdown-body img {
  background-color: #fff;
  box-sizing: content-box;
  max-width: 100%;
}

.markdown-body img[align=right] {
  padding-left: 20px;
}

.markdown-body img[align=left] {
  padding-right: 20px;
}

.markdown-body code {
  background-color: rgba(27,31,35,.05);
  border-radius: 3px;
  font-size: 85%;
  margin: 0;
  padding: .2em .4em;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre>code {
  background: transparent;
  border: 0;
  font-size: 100%;
  margin: 0;
  padding: 0;
  white-space: pre;
  word-break: normal;
}

.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body .highlight pre,
.markdown-body pre {
  background-color: #f6f8fa;
  border-radius: 3px;
  font-size: 85%;
  line-height: 1.45;
  overflow: auto;
  padding: 16px;
}

.markdown-body pre code {
  background-color: transparent;
  border: 0;
  display: inline;
  line-height: inherit;
  margin: 0;
  max-width: auto;
  overflow: visible;
  padding: 0;
  word-wrap: normal;
}

.markdown-body .commit-tease-sha {
  color: #444d56;
  display: inline-block;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 90%;
}

.markdown-body .blob-wrapper {
  border-bottom-left-radius: 3px;
  border-bottom-right-radius: 3px;
  overflow-x: auto;
  overflow-y: hidden;
}

.markdown-body .blob-wrapper-embedded {
  max-height: 240px;
  overflow-y: auto;
}

.markdown-body .blob-num {
  -moz-user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  color: rgba(27,31,35,.3);
  cursor: pointer;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
  line-height: 20px;
  min-width: 50px;
  padding-left: 10px;
  padding-right: 10px;
  text-align: right;
  user-select: none;
  vertical-align: top;
  white-space: nowrap;
  width: 1%;
}

.markdown-body .blob-num:hover {
  color: rgba(27,31,35,.6);
}

.markdown-body .blob-num:before {
  content: attr(data-line-number);
}

.markdown-body .blob-code {
  line-height: 20px;
  padding-left: 10px;
  padding-right: 10px;
  position: relative;
  vertical-align: top;
}

.markdown-body .blob-code-inner {
  color: #24292e;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
  overflow: visible;
  white-space: pre;
  word-wrap: normal;
}

.markdown-body .pl-token.active,
.markdown-body .pl-token:hover {
  background: #ffea7f;
  cursor: pointer;
}

.markdown-body kbd {
  background-color: #fafbfc;
  border: 1px solid #d1d5da;
  border-bottom-color: #c6cbd1;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #c6cbd1;
  color: #444d56;
  display: inline-block;
  font: 11px SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  line-height: 10px;
  padding: 3px 5px;
  vertical-align: middle;
}

.markdown-body :checked+.radio-label {
  border-color: #0366d6;
  position: relative;
  z-index: 1;
}

.markdown-body .tab-size[data-tab-size="1"] {
  -moz-tab-size: 1;
  tab-size: 1;
}

.markdown-body .tab-size[data-tab-size="2"] {
  -moz-tab-size: 2;
  tab-size: 2;
}

.markdown-body .tab-size[data-tab-size="3"] {
  -moz-tab-size: 3;
  tab-size: 3;
}

.markdown-body .tab-size[data-tab-size="4"] {
  -moz-tab-size: 4;
  tab-size: 4;
}

.markdown-body .tab-size[data-tab-size="5"] {
  -moz-tab-size: 5;
  tab-size: 5;
}

.markdown-body .tab-size[data-tab-size="6"] {
  -moz-tab-size: 6;
  tab-size: 6;
}

.markdown-body .tab-size[data-tab-size="7"] {
  -moz-tab-size: 7;
  tab-size: 7;
}

.markdown-body .tab-size[data-tab-size="8"] {
  -moz-tab-size: 8;
  tab-size: 8;
}

.markdown-body .tab-size[data-tab-size="9"] {
  -moz-tab-size: 9;
  tab-size: 9;
}

.markdown-body .tab-size[data-tab-size="10"] {
  -moz-tab-size: 10;
  tab-size: 10;
}

.markdown-body .tab-size[data-tab-size="11"] {
  -moz-tab-size: 11;
  tab-size: 11;
}

.markdown-body .tab-size[data-tab-size="12"] {
  -moz-tab-size: 12;
  tab-size: 12;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 .2em .25em -1.6em;
  vertical-align: middle;
}

.markdown-body hr {
  border-bottom-color: #eee;
}

.markdown-body .pl-0 {
  padding-left: 0!important;
}

.markdown-body .pl-1 {
  padding-left: 4px!important;
}

.markdown-body .pl-2 {
  padding-left: 8px!important;
}

.markdown-body .pl-3 {
  padding-left: 16px!important;
}

.markdown-body .pl-4 {
  padding-left: 24px!important;
}

.markdown-body .pl-5 {
  padding-left: 32px!important;
}

.markdown-body .pl-6 {
  padding-left: 40px!important;
}

.markdown-body .pl-7 {
  padding-left: 48px!important;
}

.markdown-body .pl-8 {
  padding-left: 64px!important;
}

.markdown-body .pl-9 {
  padding-left: 80px!important;
}

.markdown-body .pl-10 {
  padding-left: 96px!important;
}

.markdown-body .pl-11 {
  padding-left: 112px!important;
}

.markdown-body .pl-12 {
  padding-left: 128px!important;
}

  </style>
  <style>
  /**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}

  </style>
  <style>
  
  </style>
  <style>
    .markdown-body {
      box-sizing: border-box;
      min-width: 200px;
      max-width: 980px;
      margin: 0 auto;
      padding: 45px;
    }

    @media not print {
      .markdown-body {
        padding: 45px;
      }

      @media (max-width: 767px) {
        .markdown-body {
          padding: 15px;
        }
      }
    }

    .hf-container {
      color: #24292e;
      line-height: 1.3;
    }

    .markdown-body .highlight pre,
    .markdown-body pre {
      white-space: pre-wrap;
    }
    .markdown-body table {
      display: table;
    }
    .markdown-body img[data-align="center"] {
      display: block;
      margin: 0 auto;
    }
    .markdown-body img[data-align="right"] {
      display: block;
      margin: 0 0 0 auto;
    }
    .markdown-body li.task-list-item {
      list-style-type: none;
    }
    .markdown-body li > [type=checkbox] {
      margin: 0 0 0 -1.3em;
    }
    .markdown-body input[type="checkbox"] ~ p {
      margin-top: 0;
      display: inline-block;
    }
    .markdown-body ol ol,
    .markdown-body ul ol {
      list-style-type: decimal;
    }
    .markdown-body ol ol ol,
    .markdown-body ol ul ol,
    .markdown-body ul ol ol,
    .markdown-body ul ul ol {
      list-style-type: decimal;
    }
  </style>
  <style>.markdown-body a.footnote-ref {
  text-decoration: none;
}

.footnotes {
  font-size: .85em;
  opacity: .8;
}

.footnotes li[role="doc-endnote"] {
  position: relative;
}

.footnotes .footnote-back {
  position: absolute;
  font-family: initial;
  top: .2em;
  right: 1em;
  text-decoration: none;
}

.inline-math.invalid,
.multiple-math.invalid {
  color: rgb(255, 105, 105);
}
</style>
  <style>.markdown-body{}pre.front-matter{display:none!important;}/** Liber **/

.hf-container,
.markdown-body {
  font-family: "Source Sans Pro","Segoe UI","Helvetica Neue","Open Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji";
  font-size: 16px;
  line-height: 1.3;
  color: #212121;
}

:root {
  --footerHeaderBorderColor: #1c1c1c;
}
.hf-container {
  font-size: 0.75em;
}
.page-header:not(.simple) .hf-container {
  padding-bottom: 2px;
  border-bottom: 1px solid var(--footerHeaderBorderColor);
}
.page-footer:not(.simple) .hf-container {
  padding-top: 2px;
  border-top: 1px solid var(--footerHeaderBorderColor);
}

.footnotes {
  font-size: 0.75em;
  opacity: 0.9;
}
.footnotes > hr:first-of-type {
  width: 250px;
  height: 1px;
  background: var(--footerHeaderBorderColor);
}
.footnotes > ol > li > p {
  margin-top: 4px;
  margin-bottom: 4px;
}
.footnotes .footnote-back {
  color: #212121;
}
.markdown-body a.footnote-ref {
  color: #212121;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  font-weight: 600;
  color: #282828;
}

.markdown-body h1 {
  font-size: 1.8em;
}
.markdown-body h2 {
  font-size: 1.6em;
}
.markdown-body h3 {
  font-size: 1.4em;
}
.markdown-body h4,
.markdown-body h5 {
  font-size: 1.2em;
}
.markdown-body h6 {
  font-size: 1em;
  font-weight: 400;
}

.markdown-body h1,
.markdown-body h2 {
  border-bottom: none;
  padding-bottom: 0;
}

.markdown-body hr {
  background-color: #d7d8d9;
  height: 1px;
}

.markdown-body .highlight pre,
.markdown-body pre {
  background-color: #f6f8fa;
  border: 1px solid #e5e5e5;
  border-radius: 0;
}
</style>
</head>
<body>
  <article class="markdown-body"><h1 class="atx" id="前言">前言</h1>
<p>我们使用php动态渲染页面时，有很多比较麻烦的地方。</p>
<ul>
<li>在前端写好页面以后，需要后台进行修改，意味这后端程序员也需要懂前端的知识，其实渲染的工作应该交给前端来做。</li>
<li>前端没有写好页面的话，后端无法开始工作，需要等待前端的页面完成之后才能开始工作，拖延项目的进度。</li>
<li>这种渲染，属于同步渲染，先获取数据, 如果数据获取的慢了, 会严重影响整个页面渲染速度, 且数据更新需要页面刷新</li>
</ul>
<p>【演示：同步渲染】</p>
<h1 class="atx" id="http-协议回顾">http 协议回顾</h1>
<blockquote>
<p>HTTP协议，即超文本传输协议(Hypertext transfer protocol)。是一种详细规定了浏览器和服务器之间互相通信的规则</p>
<p>HTTP协议规定了<strong>请求</strong> 和<strong>响应</strong> 的标准</p>
</blockquote>
<h2 class="atx" id="请求与请求报文">请求与请求报文</h2>
<p><strong>get请求的请求报文详解</strong> </p>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//--------------------------请求行--------------------------------</span>
<span class="token comment">// GET  请求方式</span>
<span class="token comment">// /day02/01.php?username=pp&amp;password=123456    请求路径+参数（注意点）</span>
<span class="token comment">// HTTP/1.1 HTTP的版本号</span>
<span class="token constant">GET</span> <span class="token operator">/</span>day02<span class="token operator">/</span><span class="token number">01.</span>php<span class="token operator">?</span>username<span class="token operator">=</span>pp<span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">123456</span> <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>

<span class="token comment">//--------------------------请求头--------------------------------</span>
Host<span class="token operator">:</span> www<span class="token punctuation">.</span>study<span class="token punctuation">.</span>com
Connection<span class="token operator">:</span> keep<span class="token operator">-</span>alive
Upgrade<span class="token operator">-</span>Insecure<span class="token operator">-</span>Requests<span class="token operator">:</span> <span class="token number">1</span>
User<span class="token operator">-</span>Agent<span class="token operator">:</span> Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>Windows <span class="token constant">NT</span> <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token constant">WOW64</span><span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span><span class="token constant">KHTML</span><span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">58.0</span><span class="token number">.3029</span><span class="token number">.96</span> Safari<span class="token operator">/</span><span class="token number">537.36</span>
Accept<span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">*/*</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span>
Accept<span class="token operator">-</span>Encoding<span class="token operator">:</span> gzip<span class="token punctuation">,</span> deflate<span class="token punctuation">,</span> sdch
Accept<span class="token operator">-</span>Language<span class="token operator">:</span> zh<span class="token operator">-</span><span class="token constant">CN</span><span class="token punctuation">,</span>zh<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>en<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.6</span>

<span class="token comment">//----------------------------请求体-------------------------------------</span>
<span class="token operator">/</span><span class="token operator">/</span><span class="token keyword">get</span>请求没有请求体，但是参数会拼接到请求行中</code></pre>
<p><strong>POST请求的请求报文</strong> </p>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//-----------------------请求行---------------------------------------------</span>
<span class="token constant">POST</span> <span class="token operator">/</span>day02<span class="token operator">/</span><span class="token number">01.</span>php <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>

<span class="token comment">//-----------------------请求头--------------------------------------------</span>
Host<span class="token operator">:</span> www<span class="token punctuation">.</span>study<span class="token punctuation">.</span>com
Connection<span class="token operator">:</span> keep<span class="token operator">-</span>alive
<span class="token comment">//传递的参数的长度。</span>
Content<span class="token operator">-</span>Length<span class="token operator">:</span> <span class="token number">29</span>
Cache<span class="token operator">-</span>Control<span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span>
Origin<span class="token operator">:</span> http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>study<span class="token punctuation">.</span>com
Upgrade<span class="token operator">-</span>Insecure<span class="token operator">-</span>Requests<span class="token operator">:</span> <span class="token number">1</span>
User<span class="token operator">-</span>Agent<span class="token operator">:</span> Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>Windows <span class="token constant">NT</span> <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token constant">WOW64</span><span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span><span class="token constant">KHTML</span><span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">58.0</span><span class="token number">.3029</span><span class="token number">.96</span> Safari<span class="token operator">/</span><span class="token number">537.36</span>
<span class="token comment">//内容类型：表单数据，如果是post请求，必须指定这个属性。</span>
Content<span class="token operator">-</span>Type<span class="token operator">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded
Accept<span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">*/*</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span>
Referer<span class="token operator">:</span> http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>study<span class="token punctuation">.</span>com<span class="token operator">/</span>day02<span class="token operator">/</span><span class="token number">01</span><span class="token operator">-</span>login<span class="token punctuation">.</span>html
Accept<span class="token operator">-</span>Encoding<span class="token operator">:</span> gzip<span class="token punctuation">,</span> deflate
Accept<span class="token operator">-</span>Language<span class="token operator">:</span> zh<span class="token operator">-</span><span class="token constant">CN</span><span class="token punctuation">,</span>zh<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>en<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.6</span>

<span class="token comment">//------------------------请求体------------------------------------------</span>
username<span class="token operator">=</span>pp<span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">123456</span></code></pre>
<p><strong>GET请求与POST请求的对比</strong> </p>
<ul>
<li>GET请求没有请求体，因为GET请求的参数拼接到地址栏中了</li>
<li>POST请求有请求体，就是传递的参数</li>
<li>POST请求需要指定content-type属性。</li>
</ul>
<h2 class="atx" id="响应与响应报文">响应与响应报文</h2>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//---------------------状态行（响应行）-------------------------------</span>
<span class="token comment">//HTTP/1.1  HTTP版本</span>
<span class="token comment">//200 响应的状态</span>
    <span class="token comment">//200表示成功</span>
    <span class="token comment">//304表示读缓存</span>
    <span class="token comment">//404表示找不到资源</span>
    <span class="token comment">//500表示服务端错误</span>
<span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span> <span class="token number">200</span> <span class="token constant">OK</span>

<span class="token comment">//----------------------响应头-----------------------------------------------</span>
Date<span class="token operator">:</span> Thu<span class="token punctuation">,</span> <span class="token number">22</span> Jun <span class="token number">2017</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">22</span> <span class="token constant">GMT</span>
Server<span class="token operator">:</span> Apache<span class="token operator">/</span><span class="token number">2.4</span><span class="token number">.23</span> <span class="token punctuation">(</span>Win32<span class="token punctuation">)</span> OpenSSL<span class="token operator">/</span><span class="token number">1.0</span><span class="token number">.2</span>j <span class="token constant">PHP</span><span class="token operator">/</span><span class="token number">5.4</span><span class="token number">.45</span>
<span class="token constant">X</span><span class="token operator">-</span>Powered<span class="token operator">-</span>By<span class="token operator">:</span> <span class="token constant">PHP</span><span class="token operator">/</span><span class="token number">5.4</span><span class="token number">.45</span>
Content<span class="token operator">-</span>Length<span class="token operator">:</span> <span class="token number">18</span>
Keep<span class="token operator">-</span>Alive<span class="token operator">:</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> max<span class="token operator">=</span><span class="token number">100</span>
Connection<span class="token operator">:</span> Keep<span class="token operator">-</span>Alive
<span class="token comment">//内容类型，告诉浏览器该如何解析响应结果</span>
Content<span class="token operator">-</span>Type<span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">;</span>charset<span class="token operator">=</span>utf<span class="token operator">-</span><span class="token number">8</span>
<span class="token comment">//-----------------------响应体------------------------------------------------</span>
hello world</code></pre>
<h1 class="atx" id="ajax">AJAX</h1>
<blockquote>
<p>即 Asynchronous [e'sɪŋkrənəs] Javascript And XML， AJAX 不是一门的新的语言，而是对现有技术的综合利用。 本质是在HTTP协议的基础上以异步的方式与服务器进行通信。</p>
</blockquote>
<h2 class="atx" id="同步与异步">同步与异步</h2>
<p>同步和异步概念：</p>
<p>同步: 指的就是事情要一件一件做。等做完前一件才能做后一件任务</p>
<p>异步: 不受当前任务的影响，两件事情同时进行，做一件事情时，不影响另一件事情的进行。</p>
<p>编程中：异步程序代码执行时不会阻塞其它程序代码执行,从而提升整体执行效率。</p>
<img src="img/01-茶水.png">

<p>网页异步应用：</p>
<ol>
<li>验证你的用户名是否已经存在（一边输入，一边获取你的信息，和后台比对）。</li>
<li>百度搜索提示，及相关内容展示（一边输入，一边找出了你可能要的内容）。</li>
<li>新浪微博评论（异步加载）。</li>
</ol>
<p>XMLHttpRequest可以以异步方式的请求数据处理程序,  可实现对网页的部分更新， 而不是刷新整个页面</p>
<h2 class="atx" id="xmlhttprequest对象">XMLHttpRequest对象</h2>
<blockquote>
<p>浏览器内建对象，用于与服务器通信(交换数据) ， 由此我们便可实现对网页的部分更新，而不是刷新整个页面。这个请求是异步的，即在往服务器发送请求时，并不会阻碍程序的运行，浏览器会继续渲染后续的结构。</p>
</blockquote>
<pre><code class="fenced-code-block">请求由客户端发起，其规范格式为：请求行、请求头、请求主体。</code></pre>
<img src="img/02-请求规范格式.png">

<h3 class="atx" id="发送get请求">发送get请求</h3>
<p>XMLHttpRequest以异步的方式发送HTTP请求，因此在发送请求时，一样需要遵循HTTP协议。</p>
<blockquote>
<p> 使用XMLHttpRequest发送get请求的步骤</p>
</blockquote>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//1. 创建一个XMLHttpRequest对象</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//2. 设置请求行</span>
<span class="token comment">// 第一个参数:请求方式  get/post</span>
<span class="token comment">// 第二个参数:请求的地址 需要在url后面拼上参数列表</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"get"</span><span class="token punctuation">,</span> <span class="token string">"01.php?name=Jepson"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//3. 设置请求头</span>
<span class="token comment">//请求头中可以设置Content-Type,用以说明请求主体的内容是如何编码,get请求时没有请求体,无需设置</span>

<span class="token comment">//4. 设置请求体</span>
<span class="token comment">//get请求的请求体为空,因为参数列表拼接到url后面了</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>注意点 :</p>
<ul>
<li>get请求,设置请求行时,需要把参数列表拼接到url后面</li>
<li>get请求不用设置请求头, 不用说明请求主体的编码方式</li>
<li>get请求的请求体为null</li>
</ul>
<h3 class="atx" id="发送post请求">发送post请求</h3>
<pre><code class="fenced-code-block language-javascript"><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 1. 设置请求行 post请求的参数列表在请求体</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"post"</span><span class="token punctuation">,</span> <span class="token string">"02.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 设置请求头, post 请求必须要设置 content-type, 标记请求体内容的解析方式, 不然后端无法解析获取数据</span>
xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span> <span class="token string">"content-type"</span><span class="token punctuation">,</span> <span class="token string">"application/x-www-form-urlencoded"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3. 设置请求体</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> <span class="token string">"name=Jepson&amp;age=18"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>注意点 :</p>
<ul>
<li>post请求, 设置请求行时, 不拼接参数列表</li>
<li>post必须设置请求头中的content-type为application/x-www-form-urlencoded, 标记请求体解析方式</li>
<li>post 请求需要将参数列表设置到请求体中</li>
</ul>
<h3 class="atx" id="获取响应-readystate">获取响应 readyState</h3>
<p>readyState:记录了XMLHttpRequest对象的当前状态</p>
<pre><code class="fenced-code-block">readyState有五种可能的值：
xhr.readyState = 0时，UNSENT open尚未调用
xhr.readyState = 1时，OPENED open已调用
xhr.readyState = 2时，HEADERS_RECEIVED 接收到头信息
xhr.readyState = 3时，LOADING 接收到响应主体
xhr.readyState = 4时，DONE 响应完成

不用记忆状态，只需要了解有状态变化这个概念</code></pre>
<p>HTTP响应分为3个部分，状态行、响应头、响应体。</p>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//给xhr注册一个onreadystatechange事件，当xhr的状态发生状态发生改变时，会触发这个事件。</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment">//1. 获取状态行</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"状态行:"</span><span class="token operator">+</span>xhr<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//2. 获取响应头</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"所有的响应头:"</span><span class="token operator">+</span>xhr<span class="token punctuation">.</span><span class="token function">getAllResponseHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"指定响应头:"</span><span class="token operator">+</span>xhr<span class="token punctuation">.</span><span class="token function">getResponseHeader</span><span class="token punctuation">(</span><span class="token string">"content-type"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//3. 获取响应体</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre>
<h3 class="atx" id="案例">案例</h3>
<p>【判断用户名是否存在】</p>
<p>【用户登录案例】</p>
<p>【聊天机器人案例】</p>
<h2 class="atx" id="数据交互">数据交互</h2>
<pre><code class="fenced-code-block">浏览器端只是负责用户的交互和数据的收集以及展示，真正的数据都是存储在服务器端的。

我们现在通过ajax的确可以返回一些简单的数据（一个字符串）, 
但是在实际开发过程中，肯定会会设计到大量的复杂类型的数据传输，
比如数组、对象等，但是每个编程语言的语法都不一样。

因此我们会采用通过的数据交换格式（XML、JSON）来进行数据的交互。</code></pre>
<h3 class="atx" id="xml了解即可">XML(了解即可)</h3>
<p><strong>什么是XML</strong></p>
<ul>
<li>XML 指可扩展标记语言（EXtensible Markup Language）</li>
<li>XML 是一种标记语言，很类似 HTML</li>
<li>XML 的设计宗旨是传输数据，而非显示数据</li>
<li>XML 标签没有被预定义。您需要自行定义标签。</li>
</ul>
<p><strong>语法规范</strong></p>
<ul>
<li>第一行必须是版本信息</li>
<li>必须有一个根元素（有且仅有一个）</li>
<li>标签不可有空格、不可以数字或.开头、大小写敏感</li>
<li>不可交叉嵌套，都是双标签，如果是单标签，必须闭合</li>
<li>属性双引号（浏览器自动修正成双引号了）</li>
<li>特殊符号要使用实体</li>
<li>注释和HTML一样</li>
</ul>
<pre><code class="fenced-code-block language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>students</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>student</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>张三<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>age</span><span class="token punctuation">&gt;</span></span>18<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>age</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gender</span><span class="token punctuation">&gt;</span></span>男<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gender</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>desc</span><span class="token punctuation">&gt;</span></span>路人甲<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>desc</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>student</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>student</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>李四<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>age</span><span class="token punctuation">&gt;</span></span>20<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>age</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gender</span><span class="token punctuation">&gt;</span></span>男<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gender</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>desc</span><span class="token punctuation">&gt;</span></span>路人乙<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>desc</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>student</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>students</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><strong>php获取xml文件的内容</strong></p>
<pre><code class="fenced-code-block language-php"><span class="token comment">// 注意: 如果需要返回 xml 数据, 需要将 content-type 改成 text/xml, 不然浏览器以 text/html 解析</span>
<span class="token function">header</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'content-type:text/xml;charset=utf-8'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// file_get_content 用于获取文件的内容</span>
<span class="token comment">// 参数: 文件的路径</span>
<span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">file_get_content</span><span class="token punctuation">(</span> <span class="token double-quoted-string string">"data.xml"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">;</span></code></pre>
<p><strong>js解析xml</strong></p>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//获取服务端返回的xml数据，需要使用xhr.responseXML，这是一个document对象，可以使用DOM中的方法查找元素。</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> xhr<span class="token punctuation">.</span>responseXML<span class="token punctuation">;</span>
<span class="token comment">//获取所有的学生</span>
<span class="token keyword">var</span> students <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">"student"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>缺点：虽然可以描述和传输复杂数据，但是其解析过于复杂,  并且体积较大，所以实现开发已经很少使用了。</p>
<h3 class="atx" id="json数据">JSON数据</h3>
<p>JSON(JavaScript Object Notation, JS 对象标记) 是一种轻量级的数据交换格式。它基于 ECMAScript 规范，采用独立于编程语言的文本格式来存储和表示数据。</p>
<ul>
<li>数据在 键值对 中</li>
<li>数据由逗号分隔(最后一个 键值对 不能带逗号)</li>
<li>花括号保存对象，方括号保存数组</li>
<li>键使用双引号</li>
</ul>
<pre><code class="fenced-code-block language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token string">'Hello'</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token string">'World'</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//这是一个对象</span>

<span class="token comment">// 这是一个 JSON 字符串，本质是一个字符串</span>
<span class="token keyword">var</span> json <span class="token operator">=</span> <span class="token string">'{"a": "Hello", "b": "World"}'</span><span class="token punctuation">;</span></code></pre>
<p><strong>JSON数据在不同语言进行传输时，类型为字符串，不同的语言各自也都对应有解析方法，解析完成后就能很方便的使用了</strong></p>
<h4 class="atx" id="php处理json">php处理json</h4>
<ul>
<li>php关联数组 ==&gt;  json   ( json_encode )</li>
</ul>
<pre><code class="fenced-code-block language-php"><span class="token comment">// php的关联数组</span>
<span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
  <span class="token double-quoted-string string">"a"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token double-quoted-string string">"hello"</span><span class="token punctuation">,</span>
  <span class="token double-quoted-string string">"b"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token double-quoted-string string">"world"</span><span class="token punctuation">,</span>
  <span class="token double-quoted-string string">"name"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token double-quoted-string string">"鹏鹏"</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//json字符串</span>
<span class="token variable">$json</span> <span class="token operator">=</span> <span class="token function">json_encode</span><span class="token punctuation">(</span> <span class="token variable">$obj</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$json</span><span class="token punctuation">;</span></code></pre>
<ul>
<li>json ==&gt; php对象/关联数组    ( json_decode )</li>
</ul>
<pre><code class="fenced-code-block language-php"><span class="token variable">$json</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'{"a": "Hello", "b": "World"}'</span><span class="token punctuation">;</span><span class="token comment">//json字符串</span>
<span class="token comment">//第一个参数：json字符串</span>
<span class="token comment">//第二个参数：</span>
<span class="token comment">//false，将json转换成对象(默认)</span>
<span class="token comment">//true：将json转换成数组(推荐)</span>
<span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$json</span><span class="token punctuation">,</span><span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$obj</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//通过json文件获取到的内容就是一个json字符串。</span>
<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"data.json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//将json转换成数组</span>
<span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h4 class="atx" id="js处理json">JS处理json</h4>
<ul>
<li><p>JS对象 ==&gt; JSON字符串 JSON.stringify(obj)</p>
<pre><code class="fenced-code-block language-javascript">  <span class="token comment">//obj是一个js对象</span>
  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token string">'Hello'</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token string">'World'</span><span class="token punctuation">}</span>
  <span class="token comment">//result就变成了一个json字符串了</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// '{"a": "Hello", "b": "World"}'</span></code></pre>
</li>
<li><p>JSON字符串 ==&gt; JS对象  JSON.parse(obj)</p>
<pre><code class="fenced-code-block language-javascript">  <span class="token comment">//json是一个json字符串</span>
  <span class="token keyword">var</span> json <span class="token operator">=</span> <span class="token string">'{"a": "Hello", "b": "World"}'</span><span class="token punctuation">;</span>
  <span class="token comment">//obj就变成了一个js对象</span>
  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// {a: 'Hello', b: 'World'}</span></code></pre>
</li>
</ul>
<p>使用json进行数据传输</p>
<p>思考：</p>
<ol>
<li>js有一个对象，如何发送到php后台</li>
<li>php中有一个对象，如何发送到前台。</li>
</ol>
<p>【案例：获取表格数据.html】</p>
<h2 class="atx" id="兼容性处理-了解-不用处理">兼容性处理 (了解, 不用处理)</h2>
<p>现在一般最多兼容到 IE8,  这里以后见到了知道是在处理兼容性就行了</p>
<pre><code class="fenced-code-block language-javascript"><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>XMLHttpRequest<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//现代浏览器 IE7+</span>
  xhr <span class="token operator">=</span> <span class="token keyword">new</span>  <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
  <span class="token comment">//老版本的 Internet Explorer （IE5 和 IE6）使用 ActiveX 对象：</span>
  xmlHttp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">"Microsoft.XMLHTTP"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h2 class="atx" id="封装ajax工具函数">封装ajax工具函数</h2>
<blockquote>
<p>每次发送ajax请求，其实步骤都是一样的，重复了大量代码，我们完全可以封装成一个工具函数。</p>
</blockquote>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//1. 创建xhr对象</span>
<span class="token comment">//2. 设置请求行</span>
<span class="token comment">//3. 设置请求头</span>
<span class="token comment">//3. 设置请求体</span>
<span class="token comment">//4. 监听响应状态</span>
<span class="token comment">//5. 获取响应内容</span></code></pre>
<h3 class="atx" id="参数提取">参数提取</h3>
<table>
<thead>
<tr>
<th>参数名</th>
<th>参数类型</th>
<th>描述</th>
<th>传值</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td>type</td>
<td>string</td>
<td>请求方式</td>
<td>get/post</td>
<td>只要不传post，就是get</td>
</tr>
<tr>
<td>url</td>
<td>string</td>
<td>请求地址</td>
<td>接口地址</td>
<td>如果不传地址，不发送请求</td>
</tr>
<tr>
<td>async</td>
<td>boolean</td>
<td>是否异步</td>
<td>true/fase</td>
<td>只要不传false，那就是true，异步请求</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求数据</td>
<td><code>{key:value,key1:value2}</code></td>
<td>需要把这个对象拼接成参数的格式 uname=hucc&amp;upass=12345</td>
</tr>
<tr>
<td>dataType</td>
<td>string</td>
<td>返回的数据类型</td>
<td>xml/json/text</td>
<td>text</td>
</tr>
<tr>
<td>success</td>
<td>function</td>
<td>响应成功时调用</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>error</td>
<td>function</td>
<td>响应失败时调用</td>
<td>-</td>
<td>-</td>
</tr>
</tbody></table>
<h3 class="atx" id="参数检测">参数检测</h3>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">// 要求参数obj必须传递，否则直接不发送请求</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>obj <span class="token operator">||</span> <span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">"object"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 如果type传递的是post，那就发送post请求，否则发送get请求</span>
<span class="token keyword">var</span> type <span class="token operator">=</span> obj<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">"post"</span><span class="token operator">?</span><span class="token string">"post"</span><span class="token operator">:</span><span class="token string">'get'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> obj<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>url<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 只有当async传递了false，才会发送同步请求，不然只发送异步请求</span>
<span class="token keyword">var</span> async <span class="token operator">=</span> obj<span class="token punctuation">.</span>async <span class="token operator">==</span> <span class="token boolean">false</span><span class="token operator">?</span> <span class="token boolean">false</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">;</span></code></pre>
<h3 class="atx" id="完整版本">完整版本</h3>
<pre><code class="fenced-code-block language-javascript"><span class="token keyword">var</span> $ <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">ajax</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//如果options参数没有传递，直接返回。</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>options <span class="token operator">||</span> <span class="token keyword">typeof</span> options <span class="token operator">!==</span> <span class="token string">"object"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//处理默认参数</span>
    <span class="token comment">//如果参数不是post，那就默认为get</span>
    <span class="token keyword">var</span> type <span class="token operator">=</span> options<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">"post"</span> <span class="token operator">?</span> <span class="token string">"post"</span> <span class="token operator">:</span> <span class="token string">"get"</span><span class="token punctuation">;</span>
    <span class="token comment">//如果没有传url，那就传当前地址</span>
    <span class="token keyword">var</span> url <span class="token operator">=</span> options<span class="token punctuation">.</span>url <span class="token operator">||</span> location<span class="token punctuation">.</span>pathname<span class="token punctuation">;</span>
    <span class="token comment">//如果参数不是false，那就默认是true，发异步请求</span>
    <span class="token keyword">var</span> async <span class="token operator">=</span> options<span class="token punctuation">.</span>async <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token operator">?</span> <span class="token boolean">false</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getParams</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//设置请求行</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">"get"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">"?"</span> <span class="token operator">+</span> params<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> url<span class="token punctuation">,</span> async<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//设置请求头</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">"post"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"content-type"</span><span class="token punctuation">,</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//设置请求参数</span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>

    xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">/*根据响应头的content-type属性指定方法接收到的内容*/</span>
          <span class="token keyword">var</span> contentType <span class="token operator">=</span> xhr<span class="token punctuation">.</span><span class="token function">getResponseHeader</span><span class="token punctuation">(</span><span class="token string">'content-type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>contentType<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'json'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>contentType<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'xml'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            data <span class="token operator">=</span> xhr<span class="token punctuation">.</span>responseXML<span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            data <span class="token operator">=</span> xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token comment">/*执行成功函数*/</span>
          options<span class="token punctuation">.</span>success <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          options<span class="token punctuation">.</span>error <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getParams</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//将obj对象转换成参数</span>
    <span class="token comment">//将对象转换成参数列表</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token string">"="</span> <span class="token operator">+</span> obj<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"&amp;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre>
<p>【登录案例】</p>
<h2 class="atx" id="jquery中的ajax方法">jQuery中的ajax方法</h2>
<blockquote>
<p>jQuery为我们提供了更强大的Ajax封装</p>
</blockquote>
<h3 class="atx" id="ajax-1">$.ajax</h3>
<p>参数列表</p>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>描述</th>
<th>取值</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>url</td>
<td>接口地址</td>
<td></td>
<td>url:"02.php"</td>
</tr>
<tr>
<td>type</td>
<td>请求方式</td>
<td>get/post</td>
<td>type:"get"</td>
</tr>
<tr>
<td>timeout</td>
<td>超时时间</td>
<td>单位毫秒</td>
<td>timeout:5000</td>
</tr>
<tr>
<td>dataType</td>
<td>服务器返回的格式</td>
<td>json/xml/text(默认)</td>
<td>dataType:"json"</td>
</tr>
<tr>
<td>data</td>
<td>发送的请求数据</td>
<td>对象</td>
<td>data:{name:"zs", age:18}</td>
</tr>
<tr>
<td>beforeSend</td>
<td>调用前的回调函数</td>
<td>function(){}</td>
<td>beforeSend:function(){ alert(1) }</td>
</tr>
<tr>
<td>success</td>
<td>成功的回调函数</td>
<td>function (data) {}</td>
<td>success:function (data) {}</td>
</tr>
<tr>
<td>error</td>
<td>失败的回调函数</td>
<td>function (error) {}</td>
<td>error:function(data) {}</td>
</tr>
<tr>
<td>complete</td>
<td>完成后的回调函数</td>
<td>function () {}</td>
<td>complete:function () {}</td>
</tr>
</tbody></table>
<p>使用示例：</p>
<pre><code class="fenced-code-block language-javascript">$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token operator">:</span><span class="token string">"get"</span><span class="token punctuation">,</span><span class="token comment">//请求类型</span>
  url<span class="token operator">:</span><span class="token string">"02.php"</span><span class="token punctuation">,</span><span class="token comment">//请求地址</span>
  data<span class="token operator">:</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">"zs"</span><span class="token punctuation">,</span> age<span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//请求数据</span>
  dataType<span class="token operator">:</span><span class="token string">"json"</span><span class="token punctuation">,</span><span class="token comment">//希望接受的数据类型</span>
  timeout<span class="token operator">:</span><span class="token number">5000</span><span class="token punctuation">,</span><span class="token comment">//设置超时时间</span>
  <span class="token function-variable function">beforeSend</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//alert("发送前调用");</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//alert("成功时调用");</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">error</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//alert("失败时调用");</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">complete</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//alert("请求完成时调用");</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>【案例：登录案例.html】</p>
<h3 class="atx" id="其他api了解">其他api(了解)</h3>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//$.post(url, callback, [dataType]);只发送post请求</span>
<span class="token comment">//$.get(url, callback, [dataType]);</span>
<span class="token comment">//$.getJSON(url, callback);</span>
<span class="token comment">//$.getScript(url,callback);//载入服务器端的js文件</span>
<span class="token comment">//$("div").load(url);//载入一个服务器端的html页面。</span></code></pre>
<h3 class="atx" id="接口化开发">接口化开发</h3>
<p>请求地址即所谓的接口，通常我们所说的接口化开发，其实是指一个接口对应一个功能， 并且严格约束了<strong>请求参数</strong> 和<strong>响应结果</strong> 的格式，这样前后端在开发过程中，可以减少不必要的讨论， 从而并行开发，可以极大的提升开发效率，另外一个好处，当网站进行改版后，服务端接口进行调整时，并不影响到前端的功能。</p>
<h4 class="atx" id="获取短信验证码">获取短信验证码</h4>
<p><strong>需求文档(产品)</strong> </p>
<pre><code class="fenced-code-block language-javascript">总需求：点击获取验证码按钮，向服务端发送请求<span class="token punctuation">,</span> 调用服务器端短信接口<span class="token punctuation">,</span> 服务器端根据传参<span class="token punctuation">,</span> 调用第三方短信接口<span class="token punctuation">,</span> 给手机发送验证码

<span class="token function">需求1：格式校验</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> 手机号码不能为空   如果为空提示<span class="token string">"手机号不能为空"</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> 手机号码格式必须正确<span class="token punctuation">,</span> 提示<span class="token string">"请输入正确的手机号码"</span>

需求<span class="token number">2</span>：点击发送时，按钮显示为<span class="token string">"发送中"</span><span class="token punctuation">,</span>并且不能重复提交请求

<span class="token function">需求3：根据不同的响应结果，进行响应。</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>如果接口调用成功
   如果响应代码为<span class="token number">100</span>，倒计时
   <span class="token function">如果响应代码为101，提示手机号重复</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>如果接口调用失败，告诉用户<span class="token string">"服务器繁忙，请稍候再试"</span></code></pre>
<p><strong>接口文档</strong></p>
<pre><code class="fenced-code-block language-javascript">接口说明：获取短信验证码
接口地址：getCode<span class="token punctuation">.</span>php
请求方式：<span class="token keyword">get</span>
接口传参：mobile 手机号
返回类型  json
接口返回：<span class="token punctuation">{</span>
            <span class="token string">"code"</span><span class="token operator">:</span><span class="token string">"101"</span><span class="token punctuation">,</span> 
            <span class="token string">"msg"</span><span class="token operator">:</span><span class="token string">"手机号码存在"</span><span class="token punctuation">,</span> 
            <span class="token string">"mobile"</span><span class="token operator">:</span><span class="token string">"18511249258"</span>
        <span class="token punctuation">}</span>
参数说明<span class="token operator">:</span> code 当前业务逻辑的处理成功失败的标识  <span class="token number">100</span><span class="token operator">:</span>成功   <span class="token number">101</span><span class="token operator">:</span>手机号码存在
         msg  当前系统返回给前端提示
         mobile  当前的手机号码</code></pre>
<h4 class="atx" id="注册接口">注册接口</h4>
<p><strong>表单序列化</strong> serialize</p>
<p>jquery提供了一个<code>serialize()</code>方法序列化表单，说白就是将表单中带有name属性的所有参数拼成一个格式为<code>name=value&amp;name1=value1</code>这样的字符串。方便我们获取表单的数据。</p>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//serialize将表单参数序列化成一个字符串。必须指定name属性</span>
<span class="token comment">//name=pp&amp;pass=123456&amp;repass=123456&amp;mobile=15751776629&amp;code=1234</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'form'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>jquery的ajax方法，data参数能够直接识别表单序列化的数据</p>
<pre><code class="fenced-code-block language-javascript">$<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span><span class="token string">"register.php"</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'form'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  dataType<span class="token operator">:</span><span class="token string">'json'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><strong>需求文档</strong></p>
<pre><code class="fenced-code-block language-javascript">注册功能
总需求：点击注册按钮，向服务端发送请求

需求<span class="token number">1</span><span class="token operator">:</span>表单校验
    <span class="token number">1.1</span> 用户名不能为空，否则提示<span class="token string">"请输入用户名"</span>
    <span class="token number">1.2</span> 密码不能为空，否则提示<span class="token string">"请输入密码"</span>
    <span class="token number">1.3</span> 确认密码必须与密码一直，否则提示<span class="token string">"确认密码与密码不一致"</span>
    <span class="token number">1.4</span> 手机号码不能为空，否则提示<span class="token string">"请输入手机号码"</span><span class="token punctuation">;</span>
    <span class="token number">1.5</span> 手机号码格式必须正确，否则提示<span class="token string">"手机号格式错误"</span>
    <span class="token number">1.6</span> 短信验证码必须是<span class="token number">4</span>位的数字，否则提示<span class="token string">"验证码格式错误"</span>

需求<span class="token number">2</span>：点击注册按钮时，按钮显示为<span class="token string">"注册中..."</span><span class="token punctuation">,</span>并且不能重复提交请求

需求<span class="token number">3</span>：根据不同响应结果，处理响应
    <span class="token number">3.1</span> 接口调用成功
        <span class="token number">100</span> 提示用户注册成功，<span class="token number">3</span>s后跳转到首页
        <span class="token number">101</span> 提示用户<span class="token string">"用户名jepson已经存在"</span>
        <span class="token number">102</span> 提示用户<span class="token string">"验证码错误"</span>
    <span class="token number">3.2</span> 接口调用失败，提示<span class="token string">"服务器繁忙，请稍后再试"</span><span class="token punctuation">,</span>恢复按钮的值</code></pre>
<p><strong>接口文档</strong></p>
<pre><code class="fenced-code-block language-javascript">接口说明：注册
接口地址：register<span class="token punctuation">.</span>php
请求方式：post
接口传参：name<span class="token operator">:</span>用户名 pass<span class="token operator">:</span>密码 code<span class="token operator">:</span>验证码  mobile<span class="token operator">:</span>手机号
返回类型  json
接口返回：<span class="token punctuation">{</span>
            <span class="token string">"code"</span><span class="token operator">:</span><span class="token string">"100"</span><span class="token punctuation">,</span>
            <span class="token string">"msg"</span><span class="token operator">:</span><span class="token string">"注册成功"</span><span class="token punctuation">,</span>
            <span class="token string">"name"</span><span class="token operator">:</span><span class="token string">"Jepson"</span>
        <span class="token punctuation">}</span>
参数说明<span class="token operator">:</span>
      code 当前业务逻辑的处理成功失败的标识  <span class="token number">100</span><span class="token operator">:</span>成功  <span class="token number">101</span><span class="token operator">:</span>用户存在 <span class="token number">102</span><span class="token operator">:</span>验证码错误
      msg  当前系统返回给前端提示
      name<span class="token operator">:</span> 注册的用户名</code></pre>
<h1 class="atx" id="模板引擎">模板引擎</h1>
<blockquote>
<p>是为了使用户界面与业务数据（内容）分离而产生的，它可以生成特定格式的文档，用于网站的模板引擎就会生成一个标准的HTML文档。</p>
</blockquote>
<h2 class="atx" id="为什么要使用模板引擎">为什么要使用模板引擎</h2>
<p>我们通过ajax获取到数据后，需要把数据渲染到页面，在学习模板引擎前，我们的做法是大量的拼接字符串，对于结构简单的页面，这么做还行 </p>
<p>但是如果页面结构很复杂，使用拼串的话<strong>代码可阅读性非常的差，而且非常容易出错，后期代码维护也是相当的麻烦。</strong> </p>
<p>【演示：使用拼串进行渲染的缺点.html】</p>
<p>总结来说拼串渲染两大缺点：</p>
<ol>
<li>js中大量充斥着 html 结构拼串代码， 很冗余， 可读性差</li>
<li>字符串拼接很麻烦， 且维护起来也很麻烦， 容易出错</li>
</ol>
<h2 class="atx" id="常见的模板引擎">常见的模板引擎</h2>
<p>BaiduTemplate：<a href="http://tangram.baidu.com/BaiduTemplate/">http://tangram.baidu.com/BaiduTemplate/</a>
velocity.js：<a href="https://github.com/shepherdwind/velocity.js/">https://github.com/shepherdwind/velocity.js/</a>
ArtTemplate：<a href="https://github.com/aui/artTemplate">https://github.com/aui/artTemplate</a></p>
<p>artTemplate是使用最广泛，效率最高的模板引擎，需要大家掌握。</p>
<h2 class="atx" id="arttemplate的使用">artTemplate的使用</h2>
<p><a href="https://github.com/aui/art-template">github地址</a></p>
<p><a href="https://aui.github.io/art-template/docs/">中文api地址</a></p>
<h3 class="atx" id="arttemplate入门">artTemplate入门</h3>
<p><strong>1.引入模板引擎的js文件</strong> </p>
<pre><code class="fenced-code-block language-javascript"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"template-web.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></code></pre>
<p><strong>2.准备模板</strong> </p>
<pre><code class="fenced-code-block language-html"><span class="token comment">&lt;!--
  指定了type为text/html后，这一段script标签并不会解析，也不会显示。
--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/html<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myTmp<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>姓名：隔壁老王<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>年龄：<span class="token number">18</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>技能：查水表<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>描述：年轻力气壮<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><strong>3.准备数据</strong></p>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//3. 准备数据,数据是后台获取的，可以随时变化</span>
<span class="token keyword">var</span> json <span class="token operator">=</span> <span class="token punctuation">{</span>
  userName<span class="token operator">:</span><span class="token string">"隔壁老王"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">,</span>
  skill<span class="token operator">:</span><span class="token string">"查水表"</span><span class="token punctuation">,</span>
  desc<span class="token operator">:</span><span class="token string">"年轻气壮"</span>
<span class="token punctuation">}</span></code></pre>
<p><strong>4.将模板与数据进行绑定</strong></p>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//第一个参数：模板的id</span>
<span class="token comment">//第二个参数：数据</span>
<span class="token comment">//返回值：根据模板生成的字符串。</span>
<span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token function">template</span><span class="token punctuation">(</span><span class="token string">"myTmp"</span><span class="token punctuation">,</span> json<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><strong>5.修改模板</strong></p>
<pre><code class="fenced-code-block language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/html<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myTmp<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>姓名：<span class="token punctuation">{</span><span class="token punctuation">{</span>userName<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>年龄：<span class="token punctuation">{</span><span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>技能：<span class="token punctuation">{</span><span class="token punctuation">{</span>skill<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>描述：<span class="token punctuation">{</span><span class="token punctuation">{</span>desc<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><strong>6.将数据显示到页面</strong></p>
<pre><code class="fenced-code-block language-javascript"><span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> html<span class="token punctuation">;</span></code></pre>
<h3 class="atx" id="arttemplate标准语法">artTemplate标准语法</h3>
<p><strong>if语法</strong></p>
<pre><code class="fenced-code-block language-html">{{if gender='男'}}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>man<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
{{else}}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>woman<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
{{/if}}</code></pre>
<p><strong>each语法</strong></p>
<pre><code class="fenced-code-block language-html"><span class="token comment">&lt;!--
  1. {{each data}}  可以通过$value 和 $index获取值和下标
  2. {{each data v i}}  自己指定值为v，下标为i
--&gt;</span>
{{each data v i}}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{v.url}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{v.src}}<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{v.content}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
{{/each}}</code></pre>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//如果返回的数据是个数组，必须使用对象进行包裹，因为在{{}}中只写书写对象的属性。</span>
<span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token function">template</span><span class="token punctuation">(</span><span class="token string">"navTmp"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>data<span class="token operator">:</span>info<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h1 class="atx" id="瀑布流案例">瀑布流案例</h1>
<h2 class="atx" id="封装jquery瀑布流插件">封装jQuery瀑布流插件</h2>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//特点分析：</span>
<span class="token comment">//1. 跟以前将的瀑布流不一样的是，这次的瀑布流固定版心为1200px</span>
<span class="token comment">//2. 瀑布流固定摆放5列，每一列的宽度固定为232px。</span>

<span class="token comment">//思路分析：</span>
<span class="token comment">//1. 计算每一列之间的缝隙</span>
<span class="token comment">//2. 初始化一个数组，用户存储每一列的高度 [0,0,0,0,0]</span>
<span class="token comment">//3. 查找数组的最小列，每次都把图片定位到最小列的位置</span>
<span class="token comment">//4. 更新数组最小列的高度（加上定位过来的图片的高度）</span></code></pre>
<p>代码参考：</p>
<pre><code class="fenced-code-block language-javascript">$<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function-variable function">waterfall</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> $box <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> $item <span class="token operator">=</span> $box<span class="token punctuation">.</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> boxWidth <span class="token operator">=</span> $box<span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//父盒子的宽度</span>
  <span class="token keyword">var</span> itemWidth <span class="token operator">=</span> <span class="token number">232</span><span class="token punctuation">;</span><span class="token comment">//每个盒子固定宽度为232</span>
  <span class="token keyword">var</span> columns <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span class="token comment">//固定摆放5列</span>
  <span class="token keyword">var</span> gap <span class="token operator">=</span> <span class="token punctuation">(</span>boxWidth <span class="token operator">-</span> columns <span class="token operator">*</span> itemWidth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>columns <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//缝隙的宽度 10</span>
  <span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//初始化数组</span>
  $item<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//查找最小列</span>
    <span class="token keyword">var</span> min <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> minIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>min <span class="token operator">&gt;</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        min <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        minIndex <span class="token operator">=</span> i<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//设置位置</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      left<span class="token operator">:</span> minIndex <span class="token operator">*</span> <span class="token punctuation">(</span>itemWidth <span class="token operator">+</span> gap<span class="token punctuation">)</span><span class="token punctuation">,</span>
      top<span class="token operator">:</span> min
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//更新数组</span>
    arr<span class="token punctuation">[</span>minIndex<span class="token punctuation">]</span> <span class="token operator">=</span> min <span class="token operator">+</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">outerHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> gap<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h2 class="atx" id="瀑布流完整版">瀑布流完整版</h2>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//需求分析：</span>
<span class="token comment">//1. 页面刚开始，没有任何一张图片。因此需要从通过ajax获取图片</span>
<span class="token comment">//2. 使用模版引擎将获取到的数据渲染到页面</span>
<span class="token comment">//3. 因为图片路径是从服务端获取的，加载需要时间，需要等待图片加载完成后才能使用瀑布流进行布局。</span>
<span class="token comment">//4. 给window注册scroll事件，当触底时，需要动态的加载图片。</span>
<span class="token comment">//5. 加载时，显示加载中的提示信息，并且要求不能重复发送ajax请求</span>
<span class="token comment">//6. 当服务端返回图片数量为0时，提示用户没有更多数据。</span></code></pre>
<p>接口文档</p>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//接口说明：瀑布流分页数据</span>
<span class="token comment">//接口地址：data.php</span>
<span class="token comment">//请求方式：get</span>
<span class="token comment">//接口参数：page 当前是第几页    pageSize 当前页需要显示多少条</span>
<span class="token comment">//返回类型  json</span>
<span class="token comment">//返回数据：</span>
<span class="token punctuation">{</span>
  page<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  items<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>path<span class="token operator">:</span> <span class="token string">"./images/1.jpg"</span><span class="token punctuation">,</span>text<span class="token operator">:</span><span class="token string">'这是描述信息'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>path<span class="token operator">:</span> <span class="token string">"./images/2.jpg"</span><span class="token punctuation">,</span>text<span class="token operator">:</span><span class="token string">'这是描述信息'</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span>path<span class="token operator">:</span> <span class="token string">"./images/2.jpg"</span><span class="token punctuation">,</span>text<span class="token operator">:</span><span class="token string">'这是描述信息'</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
    <span class="token comment">//page   下一页的页码</span>
    <span class="token comment">//items  返回当前页的数据</span>
        <span class="token comment">//path 图片地址</span>
        <span class="token comment">//text 文字</span></code></pre>
<h1 class="atx" id="同源与跨域">同源与跨域</h1>
<h2 class="atx" id="同源">同源</h2>
<h3 class="atx" id="同源策略的基本概念">同源策略的基本概念</h3>
<blockquote>
<p>1995年，同源政策由 Netscape 公司引入浏览器。目前，所有浏览器都实行这个政策。
同源策略：最初，它的含义是指，A网页设置的 Cookie，B网页不能打开，除非这两个网页"同源"。所谓"同源"指的是"三个相同"。</p>
</blockquote>
<pre><code class="fenced-code-block language-javascript">协议相同
域名相同
端口相同</code></pre>
<p>举例来说，这个网址<code>http://www.example.com/dir/page.html</code>协议是<code>http://</code>，</p>
<p>域名是<code>www.example.com</code>，端口是<code>80</code>（默认端口可以省略）。它的同源情况如下。</p>
<pre><code class="fenced-code-block language-javascript">http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">/</span>dir2<span class="token operator">/</span>other<span class="token punctuation">.</span>html：同源

file<span class="token operator">:</span><span class="token operator">/</span><span class="token comment">//F:/phpStudy/WWW/day01/04-demo/04.html 不同源(协议不同)</span>
http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>v2<span class="token punctuation">.</span>www<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">/</span>dir<span class="token operator">/</span>other<span class="token punctuation">.</span>html：不同源（域名不同）
http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">:</span><span class="token number">81</span><span class="token operator">/</span>dir<span class="token operator">/</span>other<span class="token punctuation">.</span>html：不同源（端口不同）</code></pre>
<h3 class="atx" id="同源策略的目的">同源策略的目的</h3>
<blockquote>
<p>同源政策的目的，是为了保证用户信息的安全，防止恶意的网站窃取数据。</p>
</blockquote>
<h3 class="atx" id="同源策略的限制范围">同源策略的限制范围</h3>
<blockquote>
<p>随着互联网的发展，“同源策略”越来越严格，目前，如果非同源，以下三种行为都将收到限制。</p>
</blockquote>
<pre><code class="fenced-code-block language-javascript"><span class="token number">1.</span> Cookie、LocalStorage 和 IndexDB 无法读取。
<span class="token number">2.</span> <span class="token constant">DOM</span> 无法获得。
<span class="token number">3.</span> <span class="token constant">AJAX</span> 请求不能发送。</code></pre>
<p>虽然这些限制是很有必要的，但是也给我们日常开发带来不好的影响。比如实际开发过程中，往往都会把服务器端架设到一台甚至是一个集群的服务器中，把客户端页面放到另外一个单独的服务器。那么这时候就会出现不同源的情况，如果我们知道两个网站都是安全的话，我们是希望两个不同源的网站之间可以相互请求数据的。这就需要使用到<strong>跨域</strong> 。</p>
<h2 class="atx" id="跨域">跨域</h2>
<p>【演示跨域问题.html】</p>
<h3 class="atx" id="jsonp-无兼容性问题-">jsonp( 无兼容性问题 )</h3>
<blockquote>
<p>JSONP(JSON with Padding)、可用于解决主流浏览器的跨域数据访问的问题。</p>
<p>原理：服务端返回一个定义好的js函数的调用，并且将服务器的数据以该函数参数的形式传递过来，这个方法需要前后端配合</p>
</blockquote>
<p><code>script</code>&nbsp;标签是不受同源策略的限制的，它可以载入任意地方的 JavaScript 文件。类似的还有<code>img</code>和<code>link</code>标签</p>
<pre><code class="fenced-code-block language-html"><span class="token comment">&lt;!--不受同源策略限制的标签--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.api.com/1.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.api.com/1.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.api.com/1.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></code></pre>
<h4 class="atx" id="jsonp演化过程1">jsonp演化过程1</h4>
<p>php文件</p>
<pre><code class="fenced-code-block language-php"><span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"content-type:text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token double-quoted-string string">"alert(1111)"</span><span class="token punctuation">;</span></code></pre>
<p>html文件</p>
<pre><code class="fenced-code-block language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.api.com/testjs.php<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>原理：其实src的路径是什么文件不重要，无论引入js文件还是php文件，最后返回给浏览器的都是字符串，因此我们script标签是可以引入一个php文件的。</p>
<h4 class="atx" id="jsonp演化过程2">jsonp演化过程2</h4>
<p>php文件</p>
<pre><code class="fenced-code-block language-php"><span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"content-type:text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token double-quoted-string string">"var a = 118;"</span><span class="token punctuation">;</span></code></pre>
<p>html文件</p>
<pre><code class="fenced-code-block language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.api.com/testjs.php<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token comment">//a打印出来了118</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><strong>我们现在做到了一件事情，从不同源的php文件中获取到了数据</strong> </p>
<p>缺点：获取数据的script标签必须写在使用的script标签的前面，必须保证先有数据才能对数据进行渲染。</p>
<h4 class="atx" id="jsonp演化过程3">jsonp演化过程3</h4>
<p>php代码</p>
<pre><code class="fenced-code-block language-php"><span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"content-type:text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$arr</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token double-quoted-string string">"name"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token double-quoted-string string">"zs"</span><span class="token punctuation">,</span>
    <span class="token double-quoted-string string">"age"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token number">18</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$arr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//这是一段js函数的调用的代码，$result就是我们想要的数据</span>
<span class="token keyword">echo</span> <span class="token double-quoted-string string">"func(<span class="token interpolation"><span class="token variable">$result</span></span>)"</span><span class="token punctuation">;</span></code></pre>
<p>js代码</p>
<pre><code class="fenced-code-block language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">function</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.api.com/testjs.php<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>缺点：后端必须知道前端声明的方法的名字，后端才能调用。</p>
<h4 class="atx" id="jsonp演化过程4">jsonp演化过程4</h4>
<p>php代码</p>
<pre><code class="fenced-code-block language-php"><span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"content-type:text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$arr</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token double-quoted-string string">"name"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token double-quoted-string string">"zs"</span><span class="token punctuation">,</span>
    <span class="token double-quoted-string string">"age"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token number">18</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$arr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//这是一段js函数的调用的代码，$result就是我们想要的数据</span>
<span class="token keyword">echo</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'callback'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token double-quoted-string string">"(<span class="token interpolation"><span class="token variable">$result</span></span>)"</span><span class="token punctuation">;</span></code></pre>
<p>javascript代码</p>
<pre><code class="fenced-code-block language-javascript"><span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"button"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
button<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"script"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">"http://www.api.com/testjs.php?callback=fun"</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<ol>
<li>说白了，jsonp的原理就是 借助了script标签 src 请求资源时, 不受同源策略的限制.</li>
<li>在服务端返回一个函数的调用，将数据当前调用函数的实参。</li>
<li>在浏览器端，需要程序要声明一个全局函数，通过形参就可以获取到服务端返回的对应的值</li>
</ol>
<p>jsonp原理大家需要知道，但不用太过于去纠结这个原理，因为jquery已经帮我们封装好了，我们使用起来非常的方便。</p>
<h3 class="atx" id="jquery对于jsonp的封装">jquery对于jsonp的封装</h3>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//使用起来相当的简单，跟普通的get请求没有任何的区别，只需要把dataType固定成jsonp即可。</span>
$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token operator">:</span><span class="token string">"get"</span><span class="token punctuation">,</span>
  url<span class="token operator">:</span><span class="token string">"http://www.Jepson.com/testjs.php"</span><span class="token punctuation">,</span>
  dataType<span class="token operator">:</span><span class="token string">"jsonp"</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span><span class="token punctuation">{</span>
    uname<span class="token operator">:</span><span class="token string">"Jepson"</span><span class="token punctuation">,</span>
    upass<span class="token operator">:</span><span class="token string">"123456"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>【案例：查询天气.html】</p>
<p><a href="https://www.jisuapi.com/api/weather/">天气查询api地址</a></p>
<p>【案例：省市区三级联动.html】</p>
<p><a href="https://www.jisuapi.com/api/area/">api地址</a> </p>
<h1 class="atx" id="xmlhttprequest20">XMLHttpRequest2.0</h1>
<blockquote>
<p>XMLHttpRequest是一个javascript内置对象，使得Javascript可以进行异步的HTTP通信。2008年2月，就提出了XMLHttpRequest Level 2 草案。</p>
</blockquote>
<p>老版本的XMLHttpRequest的缺点：</p>
<pre><code class="fenced-code-block language-javascript"><span class="token number">1.</span> 仅支持传输文本数据，无法传说二进制文件，比如图片视频等。
<span class="token number">2.</span> 传输数据时，没有进度信息，只能提示完成与否。
<span class="token number">3.</span> 受到了<span class="token string">"同源策略"</span>的限制</code></pre>
<p>新版本的功能：</p>
<pre><code class="fenced-code-block language-javascript"><span class="token number">1.</span> 可以设置timeout超时时间
<span class="token number">2.</span> 可以使用formData对象管理表单数据
<span class="token number">3.</span> 允许请求不同域名下的数据（跨域）
<span class="token number">4.</span> 支持上传二进制文件
<span class="token number">5.</span> 可以获取数据传输的进度信息</code></pre>
<p><strong>注意：我们现在使用new XMLHttpRequest创建的对象就是2.0对象了，我们之前学的是1.0的语法，现在学习一些2.0的新特性即可。</strong>  </p>
<h2 class="atx" id="timeout设置超时">timeout设置超时</h2>
<pre><code class="fenced-code-block language-javascript">xhr<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">3000</span><span class="token punctuation">;</span><span class="token comment">//设置超时时间</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">ontimeout</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"请求超时"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h2 class="atx" id="formdata管理表单数据">formData管理表单数据</h2>
<blockquote>
<p>formData对象类似于jquery的serialize方法，用于管理表单数据</p>
</blockquote>
<pre><code class="fenced-code-block language-javascript">使用特点： 
<span class="token number">1.</span> 实例化一个formData对象， <span class="token keyword">new</span> <span class="token class-name">formData</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span><span class="token punctuation">;</span> form就是表单元素
<span class="token number">2.</span> formData对象可以直接作为 xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>formData<span class="token punctuation">)</span>的参数。注意此时数据是以二进制的形式进行传输。
<span class="token number">3.</span> formData有一个append方法，可以添加参数。formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"1111"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">4.</span> 这种方式只能以post形式传递，不需要设置请求头，浏览器会自动为我们设置一个合适的请求头。</code></pre>
<p>代码示例：</p>
<pre><code class="fenced-code-block language-javascript"><span class="token comment">//1. 使用formData必须发送post请求</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"post"</span><span class="token punctuation">,</span> <span class="token string">"02-formData.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//2. 获取表单元素</span>
<span class="token keyword">var</span> form <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#myForm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//3. 创建form对象，可以直接作为send的参数。</span>
<span class="token keyword">var</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//4. formData可以使用append方法添加参数</span>
formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"1111"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//5. 发送，不需要指定请求头，浏览器会自动选择合适的请求头</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>formData<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2 class="atx" id="文件上传">文件上传</h2>
<blockquote>
<p>以前，文件上传需要借助表单进行上传，但是表单上传是同步的，也就是说文件上传时，页面需要提交和刷新，用户体验不友好，xhr2.0中的formData对象支持文件的异步上传。</p>
</blockquote>
<pre><code class="fenced-code-block language-javascript"><span class="token keyword">var</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//获取上传的文件，传递到后端</span>
<span class="token keyword">var</span> file <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>formData<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2 class="atx" id="显示文件进度信息">显示文件进度信息</h2>
<blockquote>
<p>xhr2.0还支持获取上传文件的进度信息，因此我们可以根据进度信息可以实时的显示文件的上传进度。</p>
</blockquote>
<pre><code class="fenced-code-block language-javascript"><span class="token number">1.</span> 需要注册 xhr<span class="token punctuation">.</span>upload<span class="token punctuation">.</span><span class="token function-variable function">onprogress</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> 事件，用于监听文件上传的进度<span class="token punctuation">.</span>注意：需要在send之前注册。
<span class="token number">2.</span> 上传的进度信息会存储事件对象e中
<span class="token number">3.</span> e<span class="token punctuation">.</span>loaded表示已上传的大小   e<span class="token punctuation">.</span>total表示整个文件的大小</code></pre>
<p>代码参考：</p>
<pre><code class="fenced-code-block language-javascript">xhr<span class="token punctuation">.</span>upload<span class="token punctuation">.</span><span class="token function-variable function">onprogress</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  inner<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>loaded<span class="token operator">/</span>e<span class="token punctuation">.</span>total<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"%"</span><span class="token punctuation">;</span>
  span<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>loaded<span class="token operator">/</span>e<span class="token punctuation">.</span>total<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"%"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>formData<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>如果上传文件超过8M，php会报错，需要进行设置，允许php上传大文件。</p>
<h2 class="atx" id="跨域资源共享cors--兼容性ie10-">跨域资源共享(CORS) ( 兼容性IE10+ )</h2>
<h3 class="atx" id="cors的使用">cors的使用</h3>
<blockquote>
<p>新版本的XMLHttpRequest对象，可以向不同域名的服务器发出HTTP请求。这叫做<a href="http://en.wikipedia.org/wiki/Cross-Origin_Resource_Sharing">"跨域资源共享"</a>（Cross-origin resource sharing，简称CORS）。</p>
</blockquote>
<p>跨域资源共享（CORS）的前提</p>
<ul>
<li>浏览器支持这个功能( 兼容性IE10+ )</li>
<li>服务器必须允许这种跨域。</li>
</ul>
<p>服务器允许跨域的代码：</p>
<pre><code class="fenced-code-block language-php"><span class="token comment">//允许所有的域名访问这个接口</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Access-Control-Allow-Origin:*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//允许www.study.com这个域名访问这个接口</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Access-Control-Allow-Origin:http://www.study.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3 class="atx" id="cors的具体流程（了解）">CORS的具体流程（了解）</h3>
<ol>
<li><p>浏览器发送跨域请求</p>
</li>
<li><p>服务器端收到一个跨域请求后，在响应头中添加Access-Control-Allow-Origin Header资源权限配置。发送响应</p>
</li>
<li><p>浏览器收到响应后，查看是否设置了<code>header('Access-Control-Allow-Origin:请求源域名或者*');</code></p>
<p>如果当前域已经得到授权，则将结果返回给<a href="http://lib.csdn.net/base/javascript">JavaScript</a>。否则浏览器忽略此次响应。</p>
</li>
</ol>
<p>结论：</p>
<ol>
<li><strong>跨域行为是浏览器行为，响应式回来了的, 只是浏览器安全机制做了限制,  对于跨域响应内容进行了忽略。</strong></li>
<li><strong>服务器与服务器之间是不存在跨域的问题的</strong></li>
</ol>
<h3 class="atx" id="jsonp与cors的对比">jsonp与cors的对比</h3>
<ul>
<li>jsonp兼容性好，老版本浏览器也支持，但是jsonp仅支持get请求，发送的数据量有限。使用麻烦</li>
<li>cors需要浏览器支持cors功能才行。但是使用简单，<strong>只要服务端设置允许跨域，对于客户端来说，跟普通的get、post请求并没有什么区别。</strong></li>
<li>跨域的安全性问题：<strong>因为跨域是需要服务端配合控制的</strong> ，也就是说不论jsonp还是cors，如果没有服务端的允许，浏览器是没法做到跨域的。</li>
</ul>
<p>【案例：图灵机器人】</p>
<h3 class="atx" id="其他的跨域手段">其他的跨域手段</h3>
<p>以下方式基本不用啊，了解即可：</p>
<p>1、顶级域名相同的可以通过domain.name来解决，即同时设置 domain.name = 顶级域名（如example.com）
2、document.domain + iframe
3、window.name + iframe
4、location.hash + iframe
5、window.postMessage()</p>
<p><a href="http://rickgray.me/2015/09/03/solutions-to-cross-domain-in-browser.html">其他跨域方式</a></p>
</article>
</body>
</html>