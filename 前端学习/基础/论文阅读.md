# 目前学习进度汇报

```
    将这篇文章的剩余章节看完，并做了整理。这篇硕士论文，利用了许多计算机相关的技术，有三个关键技术`调度数据智能化实时采集`、`多源异构的调度大数据融合与管理`、`数字孪生驱动的智能调度决策优化`。首先，获取各种车间系统采集的相关调度数据，将数据进行初步筛选，进行多元异构数据融合获得唯一数据源，通过数据挖掘算法挖掘出调度规则，然后根据调度规则选取工件的加工机器或者二加工机器的工件。不同的的数据挖掘算法获取不同的调度结果，然后再利用数据孪生模型进行仿真预测。文章中关于如何搭建数字孪生车间并未进行信息叙述。
    从目前所读的文献来看，如果将数据孪生应用到车间调度，需要解决三个问题：
    1.数据的处理，对于获取的数据如何进行处理使得可以搭建数字孪生车间，这涉及许多新知识
    2.数字孪生车间仿真模型的搭建与运行，根据数据源将车间3d模型等成功搭建
    3.数据的获取，需要大量的真实车间的数据，需要对车间的流程具体细节很了解，还要能将这些车间的关键因素运用编程模拟运行
    这篇文章针对的是柔性作业车间动态调度，里面介绍了动态调度相关知识，通过对扰动的聚类分析，然后进行调动。不考虑以上三点问题的话，想要将数字孪生与柔性车间调度结合，并考虑第一个点，现在需要确定的是具体的调度对象，然后将其结合。数字孪生主要功用是仿真预测。
```

## 基于数字孪生的柔性作业车间动态调度研究

### 摘要
 -  随着新一代信息通信技术的不断发展，生产车间逐渐趋于智能化，如何充分利用物联网、人工智能、大数据等先进技术为车间生产提供智能化的调度支持，
实现及时交货、提高客户满意度，成为了提升企业竞争力的关键问题。柔性作业车间生产路径灵活，可以有效满足多品种、小批量的生产要求，是一种被广泛运用的车间模式。但是随着产品需求趋于个性化，制造工艺更加多样，实际柔性作业车间调度问题也变得更加复杂，制造企业对柔性作业车间调度问题的解决方法在自主性、智能性、预测性等方面提出了更高的要求。**实现制造的物理空间和信息空间的互联互通和智能化操作是实现智能制造关键，也是智能化调度的关键，是提高调度自主性、智能性、预测性的有效途径**。然而现有的调度模式难以实现信息空间与物理空间实时交互，信息空间与物理空间的数据缺乏融合。为了解决柔性作业车间动态调度问题中存在的问题，本文结合数字孪生，对柔性作业车间动态调度问题展开了研究，研究主要包括以下部分：
    - (1) 提出了数字孪生驱动的智能车间调度新模式。针对现有调度模式缺乏物理信息空间融合的问题，结合数字孪生，提出了一种**基于知识的数字孪生驱动的调度新模式**。构建了调度新模式的总体框架，并设计了该框架下的`调度数据智能化实时采集`、`多源异构的调度大数据融合与管理`、`数字孪生驱动的智能调度决策优化`三种关键技术。
    - (2) 建立了**数字孪生驱动的调度相关数据采集与融合模型**。针对柔性作业车间动态调度问题，结合`大数据技术`设计了`实时调度相关数据采集模型与离线调度相关数据采集模型`。在此基础上，构建了基于 XML 信息模板的数据清洗模型、数据整合模型、多指标筛选机制、基于扰动属性策略，用于实现调度优化的调度相关数据的数据融合增值。
    - (3) 提出了一种`基于调度知识模型的数字孪生驱动的调度优化架构`。针对柔性作业车间动态调度问题，使用` C4.5 决策树`、`改进随机森林`以及 `GAP-RBF 神经网络`三种数据挖掘算法建立了三种`调度规则挖掘模型`，在此基础上利用数字孪生概念下的仿真技术，构建`多调度知识模型的调度优化架构`。
    - (4) 对数字孪生驱动的智能车间调度新模式进行了实例验证。设计了一个柔性作业车间作为研究对象与其相应的调度历史方案、调度历史方案数据生成方式，并建立了数字孪生概念下的仿真模型，并利用调度实例，验证了数字孪生驱动的智能车间调度新模式的有效性。
- 本文的研究成果一定程度上丰富了智能制造背景下解决柔性作业车间动态调度问题的调度模式研究以及数字孪生在调度优化领域的服务运用研究。针对柔性作业车间动态调度问题给出了新的解决思路，其中结合了大数据、人工智能、数据挖掘等技术，增强了物理车间与信息空间的深度融合，从而实现自主性、先
见性的柔性作业车间智能化动态调度。
- 关键词：柔性作业车间动态调度，数字孪生，大数据，调度规则挖掘


### （一）绪论

- 研究背景及意义
    - 目前对于调度问题的研究主要集中于通过实时或离线的生产数据来驱动车间调度，并且越来越趋向于使用具有`大规模（Volume）、多样性（Variety）和高速性（Velocity）`特点的工业大数据，对于由`虚拟网络组成的信息空间与现实实体组成的物理空间之间的耦合关系`的研究也在逐步加深。
 
- 车间调度模式研究综述
    - (1) 先建模后求解的调度模式
    - (2) 运用启发式调度规则的调度模式
    - (3) 运用数据挖掘的调度模式
        - 从`与生产调度相关的历史数据中挖掘调度规则形式`的调度知识来指导实际车间调度活动。通过数据挖掘来解决调度问题的研究主要分为结合已有启发式调度规则的方法与从调度相关历史数据中挖掘调度规则的方法。

- 柔性作业车间调度研究综述
    - 单目标柔性作业车间问题
    - 多目标柔性作业车间问题
    - 静、动态柔性作业车间问题
        - 根据扰动事件发生的规律，柔性生产车间生产面临的不确定性可以分为加工能力不确定性、突发事件不确定性与外部市场不确定性。
        - 加工能力不确定性的造成原因可能是`设备运行时间、设备老化程度、零件质量不合格`等，这些原因导致了设备生产过程中的加工能力的不确定性。
        - 突发事件不确定性常由`机器故障、人为操作误差`等不确定的突发事件导致，会对生产调度产带来波动影响。
        - 外部市场不确定性的原因由市场环境改变导致，在外部竞争不断加剧的情况下,企业的开放程度也不断变强，市场需求的波动或价格变化、原材料的供应情况都会加剧生产调度系统的不确定性。

- 数字孪生研究综述
    - 数字孪生是虚拟世界中的一种虚拟的、动态的模型，它与现实世界中对应的物理实体完全一致，能够及时地模拟物理实体的特征、行为、性能等。


### （二）数字孪生驱动的智能车间调度新模式

- 传统调度模式在信息物理融合方面的不足分析
    1. 关注的数据类型单一。传统的调度模式通常只关注于信息空间数据或物理空间数据中的一种，无法同时充分利用信息空间与物理空间的调度相关数据。
    2. 缺乏物理信息空间数据深度融合增值的方法。传统调度模式只对调度数据进行简单的处理，没有针对物理空间产生的调度相关数据、信息空间产生的调度相关数据以及结合物理信息空间的调度相关数据进行数据融合增值，无法充分利用数据中蕴含的调度知识。
    3. 缺乏使用深度融合调度相关数据的调度决策优化方法。在传统的调度模式中，缺乏使用大数据、人工智能、数据挖掘等技术并结合深度融合后的调度相关数据，实时连续快速地对调度决策进行优化的方法。
    4. 缺乏主动性。由于物理空间与信息空间融合不足，物理空间与信息空间无法实现实时交互，物理空间与信息空间的延迟导致了所有的调度决策都是事后被动做出的，例如在传统的调度模式，在机器故障后，才会进行做出相应的调度方案调整。


- 数字孪生驱动的智能车间调度模式
    - 针对传统的调度模式在信息物理空间的交互与融合研究中存在的问题，本文基于数字孪生的概念，在陶飞等提出的数字孪生车间模式基础上，提出了一种基于数字孪生驱动的调度新模式，其具体架构如图所示。该架构由 5 个部分与三个关键技术构成。其中五个部分包括`物理车间、虚拟车间、调度数据融合框架、孪生调度数据源、智能调度决策执行系统`，三个关键技术包括`智能化调度数据智能化实时采集、多源异构调度大数据融合与管理与数字孪生驱动的车间调度决策智能优化`。
    - 在要素层面，虚拟车间通过三维软件和有限元法对人、机、物、环境等生产要素的几何模型和物理特性进行全面刻画。
    - 在行为层面，虚拟车间通过 FlexSim、Demo3d 等三维仿真工具对车间要素的行为和响应机制进行建模，得到人员行为、设备操作和物料运输等虚拟化模型。
    - 在规则层面，虚拟车间通过数据分析算法、数据挖掘算法构建得到车间要素间的关联规则模型、车间运行规则模型和演化规则模型，保证数字孪生车间的运行机制能够与实际情况相匹配，真实地模拟物理车间的行为、状态、运行和演化。
    - 调度数据融合框架可以将物理车间、虚拟车间及智能调度决策执行系统产生的调度相关数据进行数据集成与融合，以此构建一个单一的数据源（孪生调度数据源），作为驱动智能车间调度的数据共享平台。
    - 多源异构调度大数据融合与管理技术的目的是将采集的信息空间与物理空间的所有与调度相关的实时数据与历史数据进行深度融合，为从调度相关数据中提取调度知识奠定基础。
    - 数字孪生驱动的车间调度决策智能优化技术是一种结合了大数据、人工智能、数据挖掘技术，从融合后的调度相关数据中提取调度知识用于实时连续快速得到调度优化决策的具体实现方法。此外，使用数字孪生驱动的车间调度决策智能优化技术可以主动感知异常，快速确定异常范围，判断是否需要做出响应。
    
- 数字孪生驱动的智能车间调度关键技术
    - ①调度数据智能化实时采集；
        - 调度相关数据实时采集是在虚拟车间构建高保真数字孪生模型的重要前提，其目标是对实时调度活动涉及到的所有多源异构数据进行采集，为数字孪生驱动的智能车间调度提供数据支持。
        - 调度要素实时状态数据包括工件加工状态数据、设备运行状态数据、人员状态数据、物料配送状态数据等。
        - 调度过程数据是产品在生产过程中产生的数据，包括加工进度数据、加工时间数据、产品质量数据等。
        - 调度活动计划数据由各调度方案的数据组成，包括工件每道工序的加工机器、机器前工件的加工顺序等
        - ![](_v_images/20200222152350844_25212.png)
    - ②多源异构调度大数据融合与管理；
        - 多源异构的调度大数据融合的目的是通过全要素、全业务、全流程的调度大数据集成，以此消除信息孤岛并提高数据利用率。
        - 这些多源异构的调度大数据之间的关系可以分为三类，即冗余性、互补性和协同性。
        - 冗余数据是指两个或多个数据源提供相同的数据块，通过数据融合可以提高数据的准确性和可靠性。
        - 互补数据是指来自不同数据源的数据分别为描述目标完整信息中不同且不可缺少的部分，只有将所有的互补数据融合在一起，才能得到目标的完整信息。
        - 协同数据意味着从不同数据源收集的数据之间具有关联关系，通过融合协同数据可以更加全面地描述车间调度的行为、规则、约束。
    - ③数字孪生驱动的车间调度决策智能优化。
        - 车间调度是生产过程管理和控制的神经中枢，当车间发生扰动时，生产计划首先受到影响。数字孪生驱动的智能调度决策优化，主要是通过全要素、全过程、全业务的调度数据集成与共享平台（孪生调度数据源）中所蕴含的调度优化知识进行挖掘与应用，实现调度决策的迭代优化调整。
        - ![](_v_images/20200222154242714_31781.png)
        - 当物理车间的实时调度运行数据与预定义的值（当前调度方案计划在仿真中的各项数据）出现偏差时，虚拟车间中调度方案优化服务模型会主动感知异常，快速确定异常范围，判断是否需要做出响应。
        - 在调度方案优化服务模型中，针对调度优化问题，`有多个由不同知识挖掘算法得到的知识模型`。若需要对异常做出响应，调度方案优化服务模型会利用这些知识模型，并结合仿真与预测手段得到各自的优化结果，并选出最优的决策方案。
        - 该调度决策优化模式下的智能性主要体现在以下四个方面：一是当异常发生时，调度方案优化模型主动感知，快速判断，敏捷响应，是一种主动应对型的优化模式；二是利用孪生调度数据源中所蕴涵的调度知识来指导车间调度，是一种低计算成本且快速的优化模式；三是使用多个知识模型，结合仿真、预测、评估等手段选出最优方案，是一种优中选优的优化模式；四是各服务模型利用选出的最优方案不断更新自身的知识模型，实现知识模型的自我完善，是一种不断再学习的优化模式。
        - 调度方案优化服务模型中的每一个调度知识模型都可以看做是一个富含调度知识的调度领域专家，借助数字孪生技术从多个专家的建议中选出最优的方案，保证了最终调度决策的可行性与有效性。同时，每次最优调度方案的仿真结果都会转化为训练实例，用于更新调度知识模型。

### （三）新调度模式下柔性作业车间动态调度问题数据处理

- 新调度模式下调度任务定义
    - 使用调度规则解决调度问题是一种实时调度的方法，需要将柔性作业车间的机器分配问题与作业排序问题转化为实时问题。因此，挖掘所得调度规则的调度任务可以看作是在考虑扰动的情况下解决如下两个子问题：
    - (1) 工件的机器选择问题：工件在加工第一道工序前或是加工完一道工序进入下一道工序时，工件从可加工的机器中选择最合适的机器。
    - (2) 空闲机器选择加工工件问题：当机器加工完工件，从机器前等待的工件中选择最合适的工件进行加工。
    - 通过两两比较选出最优的方法，最终可以将上述两个子问题转换成以下两个分类问题：
    - (1) 对于某一工件的某道工序，给定可以加工这道工序的机器集合中的任意两台机器，将这两台机器进行比较，区分出适合该工件加工的机器与不适合该工件加工的机器。
    - (2) 对于某台空闲机器，给定在这台机器排队等待加工的工件集合中任意两个工件，将这两个工件进行比较，区分出加工优先性高的工件与加工优先性低的工件。

- 新调度模式下柔性作业车间动态调度问题相关数据采集模型
    - 在数字孪生驱动的调度模式下，需要构建调度孪生数据源，作为调度优化的唯一调度数据集成与共享平台。智能车间的调度相关数据采集是构建调度孪生数据源的基础，也是调度规则挖掘的前提。在物理车间与虚拟车间中需要采集的调度相关数据可以分为`调度规则挖掘所需数据`与`调度规则运用所需数据`。
    - 此外，考虑到柔性作业车间动态调度问题是在有扰动的环境下解决工件的机器选择问题和空闲机器的工件选择问题，所以可以将采集的调度相关数据集合Dh，包括调度规则挖掘所需数据和调度规则运用所需数据，分为如下 d1,d2,d3三个部分
    -  >>d1：调度方案制定时或调度规则运用时与扰动相关的系统扰动信息。例如机器故障信息、紧急订单信息、物料缺失信息、返工信息、人员离岗信息等。
    - >>d2：工件的某道工序选择加工机器时，当前可以加工这道工序的机器集合中的每台机器的状态信息。例如机器前在制品数量、机器加工完在制品所需时间、机器加工这道工序的时间、机器故障情况、机器开工时间、负责人员在岗情况等。
    - >>d3：为空闲机器需要在等待队列中选择工件进行加工时，当前队列中的每个工件的状态信息。例如工件在此机器上加工的时间、工件是否为返工工件、工件所属订单是否延期及延期时间、工件所属订单的提前期等。
    - ![](_v_images/20200222163226596_19260.png)
    - 多指标筛选机制中选择了`最大完工时间、总拖期时间、机器总负`荷三个指标作为筛选的依据，能同时满足这三个指标的调度方案在执行中产生的调度数据集合，将会作为调度规则挖掘算法的输入。在最大完工时间指标上，以同种情况下只使用 SPT（Shortest Process Time，最短加工时间规则）规则生成的的调度方案的最大完工时间作为筛选标准。只使用 SPT 规则是指工件选择加工最快的机器与空闲机器选择加工时间最短的工件。在总拖期时间指标上，以同种情况下使用EDD(Earliest Job Due Date，最早交货期规则)规则结合 SPT 规则完成相同情况下的调度任务的总延期时间作为筛选标准。SPT+EDD 规则是指是指工件选择加工最快的机器与空闲机器选择交货期最早的工件。在机器总负荷指标上，以同种情况下结合 LMWT（Longest Machine Waiting Time，设备最长等待时间调度规则）与 SPT 规则完成调度任务的机器总负荷作为筛选标准，LMWT+SPT 规则是指工件选择空闲时间最长的机器与空闲机器选择加工时间最短的工件。
    - 一次性扰动单次发生就能够对生产调度产生足够大影响的不确定事件，根据其对调度资源的作用不同，可以分为设备扰动、任务扰动和物料扰动。
    - 设备扰动会对车间内的机器设备产生影响，对生产调度的执行起到重大且不易恢复的作用。这其中包含了机器机械障碍、电源系统引起的机器运转停滞，操作错误产生的机器停机等。
    - 任务扰动的出现会引发既定生产任务的变动，使得待生产的工件发生变化，其中有待加工工件的数量忽然增多或降低，加工工序的调整等。该种类扰动涵盖的事件有：**高优先级订单的添加、订单的撤回、工件因质量问题而造成的返工等**。
    - 物料扰动即为物料质量缺陷或临时短缺。与一次性扰动有明显的差异，其单次出现对制造任务的进行不会产生较大干扰。不过当此类扰动伴随时间和频次的增加，其影响作用积攒到一定量能后，一样也会对车间生产系统的常态运转产生重大的负面影响。此类扰动包括的事件有：实际生产中的工时偏差、工序变动和物流作业的时间偏差、设备刀具的摩擦损耗、生产工人作业效率的变化等。
    - ![](_v_images/20200222170224012_3727.png)

### （四）新调度模式下柔性作业车间动态调度优化架构

>> 通过第一章对于柔性作业车间调度问题研究的总结可以发现，**目前采用调度知识挖掘的手段解决柔性作业车间调度问题的研究较少**。由此本章构建了针对柔性作业车间调度问题的调度规则挖掘模型。同时，由于数据挖掘的方法众多，每种数据挖掘方法都有各自的优缺点，无法保证通过一种数据挖掘方法得到的调度规则在任何情况下，都有不错的调度性能表现。因此，本章提出了一种`多调度知识模型`的调度优化方法。`根据柔性作业车间动态调度问题的特点与所定义的调度规则的调度任务，本章选取了决策树、随机森林以及 GAP-RBF 神经网络作为多调度知识模型的调度优化方法中调度规则挖掘算法`。


- 基于 C4.5 决策树的调度规则挖掘模型设计
    - 决策树算法是一种常用的数据挖掘算法，以此作为调度规则的挖掘算法具有计算量小、调度知识表达直观、能够处理数字和其他类别的数据等优点，因此被广泛运用于**普通作业车间静态调度问题的调度规则挖掘**的研究中。
    - 决策树的建立完全依赖于训练实例，因此决策树往往对于训练数据具有很好的分类能力，然而决策树的泛化能力弱，容易对训练样本中的噪声属性与噪声数据过度拟合，对于未知的测试数据未必有很好的分类能力。剪枝通过对复杂的决策树进行简化，修剪调一些不必要的分支，是解决决策树过拟合问题的方法之一。
    - 在通过 C4.5 算法挖掘得到随机森林调度规则后，就可以**使用决策树调度规则区分出合适的机器，或得到加工优先程度高的工件**。例如，某工件的工序OperationX 需要在 m1、m2、m3 中选择一台最合适的机器进行加工。首先，找到与当前柔性作业车间的扰动环境所对应的簇中的决策树调度规则 1，以此作为区分合适机器的依据。在此基础上，先从 m1 与 m2 中找出适合 OperationX 加工的机器，将 m1、m2 的实时信息输入决策树调度规则 1，得到决策树的分类结果，这些结果可能为 1 或 2（1 代表前者 m1 合适，2 代表后者 m2 合适）。得到 m1与 m2 中合适的机器以后，用相同的方法与 m3 比较，就能得到最适合 OperationX加工的机器。


- 数字孪生驱动的多知识模型调度优化架构设计
    - 本文提出数字孪生驱动的调度模式是一种借助于调度规则形式的调度知识与数字孪生技术结合来指导解决调度问题的方法。数据挖掘方法多种多样，每种方法都有自身的优点与缺点，在使用数据挖掘方法来进行调度规则挖掘时，每种方法都有自身的优势与不足
    - ![](_v_images/20200222180016040_23550.png)
    