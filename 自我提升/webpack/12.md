## tree shaking(摇树优化)

- 概念：1 个模块可能有多个方法，只要其中的某个方法使用到了，则整个文件都会被打到bundle 里面去，tree shaking 就是只把用到的方法打入bundle ，没用到的方法会在uglify 阶段被擦除掉。
- 使⽤用：webpack 默认支持，在.babelrc 里设置modules: false 即可
    - production mode的情况下默认开启
- 要求：必须是ES6 的语法，CJS 的方式不支持

![](_v_images/20200612163545112_25204.png =826x)

### Tree-shaking 原理

- 利用ES6 模块的特点:
    - 只能作为模块顶层的语句出现
    - import 的模块名只能是字符串常量
    - import binding 是immutable的
- 代码擦除： uglify 阶段删除无用代码

不能有副作用

副作用这个概念来源于函数式编程(FP)，纯函数是没有副作用的，也不依赖外界环境或者改变外界环境。纯函数的概念是：接受相同的输入，任何情况下输出都是一样的。

非纯函数存在副作用，副作用就是：相同的输入，输出不一定相同。或者这个函数会影响到外部变量、外部环境。

函数如果调用了全局对象或者改变函数外部变量，则说明这个函数有副作用。